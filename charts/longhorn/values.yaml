# üíæ Longhorn - Configura√ß√µes Helm Chart
# Sistema de armazenamento distribu√≠do para Kubernetes com interface web para gerenciamento de volumes

# =============================================================================
# üöÄ CONFIGURA√á√ÉO ESSENCIAL
# =============================================================================
# Estas s√£o as configura√ß√µes que 80% dos usu√°rios v√£o alterar

# Dom√≠nio onde a interface web do Longhorn ser√° acess√≠vel
# Exemplo: longhorn.meusite.com
domain: "longhorn.meusite.com"

# =============================================================================  
# ‚ö° FUNCIONALIDADES OPCIONAIS
# =============================================================================
# Funcionalidades que podem ser habilitadas conforme necess√°rio

# Autentica√ß√£o B√°sica para interface web
auth:
  enabled: true # Habilita autentica√ß√£o b√°sica (recomendado para produ√ß√£o)
  username: "admin" # Usu√°rio para login na interface
  password: "" # Senha para login (DEVE ser definida)

# Configura√ß√£o TLS/HTTPS
tls:
  enabled: false # Habilita HTTPS autom√°tico

# =============================================================================
# üîß CONFIGURA√á√ÉO AVAN√áADA (OPCIONAL)
# =============================================================================
# Configura√ß√µes para usu√°rios experientes (raramente alteradas)

# Sobrescrever nomes dos recursos
nameOverride: "" # Sobrescreve o nome do chart
fullnameOverride: "" # Sobrescreve o nome completo dos recursos

# Componente para identifica√ß√£o nos labels
component: "storage" # Tipo de componente (storage, application, database, etc.)

# Configura√ß√µes extremamente avan√ßadas (apenas se necess√°rio)
advanced:
  enabled: false # Habilita se√ß√£o de configura√ß√µes avan√ßadas

  # ‚ö†Ô∏è Configura√ß√µes abaixo s√≥ s√£o aplicadas se advanced.enabled=true

  # Anota√ß√µes personalizadas nos recursos
  annotations: {}

  # Labels personalizadas adicionais
  labels: {}

  # ========================================================================
  # üì¶ CONFIGURA√á√ïES DO SUBCHART LONGHORN OFICIAL (v1.9.0)
  # ========================================================================
  # Essas configura√ß√µes s√£o passadas diretamente para o chart oficial do Longhorn
  # Consulte: https://longhorn.io/docs/1.9.0/references/helm-values/

  longhorn:
    # üíæ CONFIGURA√á√ïES DE PERSIST√äNCIA E STORAGECLASS
    # Configura√ß√µes para cria√ß√£o autom√°tica da StorageClass e comportamento dos volumes
    persistence:
      defaultClass: true # Define Longhorn como StorageClass padr√£o do cluster
      defaultClassReplicaCount: 2 # N√∫mero de r√©plicas padr√£o para novos volumes (m√≠n: 2, m√°x: 20)
      defaultDataLocality: "disabled" # Localidade dos dados ("disabled", "best-effort", "strict-local")
      defaultFsType: "ext4" # Sistema de arquivos padr√£o para novos volumes ("ext4", "xfs")

    # üåê CONFIGURA√á√ïES DE REDE E SERVI√áOS
    # Configura√ß√µes dos servi√ßos internos do Longhorn
    service:
      ui:
        type: ClusterIP # Tipo do servi√ßo da UI ("ClusterIP", "NodePort", "LoadBalancer")
        nodePort: null # Porta espec√≠fica para NodePort (deixe null para auto)
      manager:
        type: ClusterIP # Tipo do servi√ßo do Manager ("ClusterIP", "NodePort")
        nodePort: null # Porta espec√≠fica para NodePort (deixe null para auto)

    # ‚öôÔ∏è CONFIGURA√á√ïES PADR√ÉO DO SISTEMA LONGHORN
    # Configura√ß√µes avan√ßadas que afetam o comportamento do sistema
    defaultSettings:
      # üîÑ Configura√ß√µes de Backup e Recupera√ß√£o
      backupTarget: "" # URL do destino de backup (s3://bucket, nfs://server/path, etc.)
      backupTargetCredentialSecret: "" # Nome do secret com credenciais do backup target
      backupstorePollInterval: 300 # Intervalo de verifica√ß√£o do backupstore (segundos)

      # üíø Configura√ß√µes de Disco e Armazenamento
      createDefaultDiskLabeledNodes: false # Cria disco padr√£o apenas em nodes com label espec√≠fica
      defaultDataPath: "/var/lib/longhorn/" # Caminho padr√£o para armazenar dados nos nodes
      defaultLonghornStaticStorageClass: "longhorn" # Nome da StorageClass est√°tica padr√£o
      defaultReplicaCount: 2 # N√∫mero padr√£o de r√©plicas para volumes criados via UI

      # üöÄ Configura√ß√µes de Performance e Recursos
      guaranteedInstanceManagerCPU: 12 # % de CPU reservada para Instance Manager (1-40%)
      storageOverProvisioningPercentage: 100 # % de over-provisioning permitido (100-1000%)
      storageMinimalAvailablePercentage: 25 # % m√≠nimo de espa√ßo livre obrigat√≥rio (0-100%)

      # üîß Configura√ß√µes de Manuten√ß√£o e Limpeza
      orphanAutoDeletion: true # Remove automaticamente recursos √≥rf√£os
      autoSalvage: true # Recupera automaticamente volumes com r√©plicas defeituosas
      autoCleanupSystemGeneratedSnapshot: true # Remove snapshots tempor√°rios automaticamente

      # üìä Configura√ß√µes de Monitoramento e Upgrade
      upgradeChecker: true # Verifica novas vers√µes do Longhorn periodicamente
      allowCollectingLonghornUsageMetrics: true # Permite coleta de m√©tricas an√¥nimas de uso

    # üè∑Ô∏è CONFIGURA√á√ïES DE TOLER√ÇNCIAS E SELETORES
    # Configura√ß√µes para agendamento de pods em nodes espec√≠ficos
    longhornManager:
      # Toler√¢ncias para o DaemonSet do Longhorn Manager
      tolerations:
      - key: "CriticalAddonsOnly" # Permite execu√ß√£o em nodes com taint cr√≠tico
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"
      nodeSelector: {} # Seletor de nodes para Longhorn Manager
      priorityClass: "longhorn-critical" # Classe de prioridade para evitar evictions

    longhornDriver:
      # Toler√¢ncias para o Driver (CSI)
      tolerations:
      - key: "CriticalAddonsOnly" # Permite execu√ß√£o em nodes com taint cr√≠tico
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"
      nodeSelector: {} # Seletor de nodes para Driver
      priorityClass: "longhorn-critical" # Classe de prioridade para evitar evictions

    longhornUI:
      # Toler√¢ncias para a Interface Web
      tolerations:
      - key: "CriticalAddonsOnly" # Permite execu√ß√£o em nodes com taint cr√≠tico
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"
      nodeSelector: {} # Seletor de nodes para UI
      priorityClass: "longhorn-critical" # Classe de prioridade para evitar evictions
      replicas: 2 # N√∫mero de r√©plicas da interface web (recomendado: 2+ para HA)

    # üñºÔ∏è CONFIGURA√á√ïES DE IMAGENS
    # Controle das vers√µes das imagens dos componentes (normalmente n√£o precisa alterar)
    image:
      pullPolicy: "IfNotPresent" # Pol√≠tica de download das imagens ("Always", "IfNotPresent", "Never")

    # üîê CONFIGURA√á√ïES DE SEGURAN√áA
    # Configura√ß√µes relacionadas √† seguran√ßa e acesso
    enablePSP: false # Habilita Pod Security Policies (apenas K8s < 1.25)

    # üìà CONFIGURA√á√ïES DE M√âTRICAS E MONITORAMENTO
    # Integra√ß√£o com Prometheus/Grafana
    metrics:
      serviceMonitor:
        enabled: false # Habilita ServiceMonitor para Prometheus Operator
        interval: "" # Intervalo de coleta de m√©tricas (ex: "30s")
        additionalLabels: {} # Labels adicionais para o ServiceMonitor
